diff --git a/cinder/api/openstack/wsgi.py b/cinder/api/openstack/wsgi.py
index 2c9d78a..b59a52e 100644
--- a/cinder/api/openstack/wsgi.py
+++ b/cinder/api/openstack/wsgi.py
@@ -18,6 +18,7 @@ import collections
 import functools
 import inspect
 import math
+import sys
 import time
 
 from oslo_log import log as logging
@@ -41,6 +42,9 @@ from cinder.i18n import _
 from cinder import utils
 from cinder.wsgi import common as wsgi
 
+if sys.version_info[0] == 2:
+    reload(sys)
+    sys.setdefaultencoding('utf-8')
 
 LOG = logging.getLogger(__name__)
 
diff --git a/cinder/api/v3/volumes.py b/cinder/api/v3/volumes.py
index b2e51e9..0986a33 100644
--- a/cinder/api/v3/volumes.py
+++ b/cinder/api/v3/volumes.py
@@ -190,12 +190,6 @@ class VolumeController(volumes_v2.VolumeController):
                     "the latest one of volume %(v_id)s.")
             raise exc.HTTPBadRequest(explanation=msg % {'s_id': snapshot_id,
                                                         'v_id': volume.id})
-        if volume.size != l_snap.volume_size:
-            msg = _("Can't revert volume %(v_id)s to its latest snapshot "
-                    "%(s_id)s. The volume size must be equal to the snapshot "
-                    "size.")
-            raise exc.HTTPBadRequest(explanation=msg % {'s_id': snapshot_id,
-                                                        'v_id': volume.id})
         try:
             msg = 'Reverting volume %(v_id)s to snapshot %(s_id)s.'
             LOG.info(msg, {'v_id': volume.id,
diff --git a/tox.ini b/tox.ini
index 15b4808..ce82716 100644
--- a/tox.ini
+++ b/tox.ini
@@ -14,7 +14,7 @@ setenv = VIRTUAL_ENV={envdir}
 usedevelop = True
 install_command = pip install {opts} {packages}
 
-deps = -c{env:UPPER_CONSTRAINTS_FILE:https://releases.openstack.org/constraints/upper/stein}
+deps = -c{toxinidir}/../requirements/upper-constraints.txt
         -r{toxinidir}/test-requirements.txt
         -r{toxinidir}/requirements.txt
 
@@ -36,7 +36,7 @@ passenv = *_proxy *_PROXY
 basepython = python3
 whitelist_externals = rm
 deps =
-    -c{env:UPPER_CONSTRAINTS_FILE:https://releases.openstack.org/constraints/upper/stein}
+    -c{toxinidir}/../requirements/upper-constraints.txt
     -r{toxinidir}/doc/requirements.txt
 commands =
   rm -rf api-ref/build
@@ -45,7 +45,7 @@ commands =
 [testenv:releasenotes]
 basepython = python3
 deps =
-  -c{env:UPPER_CONSTRAINTS_FILE:https://releases.openstack.org/constraints/upper/stein}
+  -c{toxinidir}/../requirements/upper-constraints.txt
   -r{toxinidir}/requirements.txt
   -r{toxinidir}/doc/requirements.txt
 commands = sphinx-build -a -E -W -d releasenotes/build/doctrees -b html releasenotes/source releasenotes/build/html
@@ -74,7 +74,7 @@ setenv =
   OS_TEST_PATH = ./cinder/tests/compliance
 
 [testenv:pep8]
-basepython = python3
+basepython = python2
 commands =
   flake8 {posargs} .
   {toxinidir}/tools/config/check_uptodate.sh
@@ -92,6 +92,7 @@ passenv = FAST8_NUM_COMMITS
 basepython = python3
 deps = -r{toxinidir}/requirements.txt
        -r{toxinidir}/test-requirements.txt
+       -c{toxinidir}/../requirements/upper-constraints.txt
        pylint==2.1.1
 commands =
   bash ./tools/coding-checks.sh --pylint {posargs}
@@ -121,7 +122,7 @@ basepython = python3
 commands = oslopolicy-sample-generator --config-file=tools/config/cinder-policy-generator.conf
 
 [testenv:genopts]
-basepython = python3
+basepython = python2
 sitepackages = False
 envdir = {toxworkdir}/pep8
 commands = python tools/config/generate_cinder_opts.py
@@ -133,7 +134,7 @@ commands = {posargs}
 [testenv:docs]
 basepython = python3
 deps =
-  -c{env:UPPER_CONSTRAINTS_FILE:https://releases.openstack.org/constraints/upper/stein}
+  -c{toxinidir}/../requirements/upper-constraints.txt
   -r{toxinidir}/requirements.txt
   -r{toxinidir}/doc/requirements.txt
 commands =
@@ -153,6 +154,7 @@ commands = python {toxinidir}/tools/generate_driver_list.py
 [testenv:bandit]
 basepython = python3
 deps = -r{toxinidir}/test-requirements.txt
+       -c{toxinidir}/../requirements/upper-constraints.txt
 commands = bandit -r cinder -n5 -x tests -ll
 
 [testenv:bandit-baseline]
